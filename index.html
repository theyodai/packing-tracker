<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–£—á—ë—Ç —É–ø–∞–∫–æ–≤–∫–∏</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f4f6f8;
      color: #222;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      font-size: 22px;
      margin-bottom: 10px;
    }

    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 420px;
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 10px;
      text-align: center;
    }

    th {
      background: #f0f0f0;
    }

    input[type="number"] {
      width: 60px;
      padding: 6px;
      font-size: 15px;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    button {
      padding: 10px 12px;
      font-size: 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s;
      color: white;
    }

    button:hover {
      opacity: 0.9;
    }

    .add-btn {
      background: #007aff;
    }

    .save-btn {
      background: #34c759;
      width: 100%;
      margin-top: 15px;
    }

    .reset-btn {
      background: #ff3b30;
      width: 100%;
      margin-top: 10px;
    }

    .clear-history-btn {
      background: #8e8e93;
      width: 100%;
      margin-top: 10px;
    }

    .stats {
      text-align: center;
      font-size: 16px;
      line-height: 1.6;
      margin-top: 10px;
    }

    .history {
      width: 100%;
      max-width: 420px;
    }

    .history table {
      font-size: 14px;
    }

    .total-summary {
      text-align: right;
      margin-top: 10px;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <h1>–£—á—ë—Ç —É–ø–∞–∫–æ–≤–∫–∏</h1>

  <div class="card">
    <table>
      <tr>
        <th>–¢–∏–ø</th>
        <th>–¶–µ–Ω–∞</th>
        <th>–ö–æ–ª-–≤–æ</th>
        <th>+</th>
      </tr>
      <tr>
        <td>–ú–∞–ª–µ–Ω—å–∫–∏–π</td>
        <td>0.35 ‚ÇΩ</td>
        <td><input type="number" id="input-small" value="0" min="0" onchange="updateFromInput('small')"></td>
        <td><button class="add-btn" onclick="add('small')">+</button></td>
      </tr>
      <tr>
        <td>–ë–æ–ª—å—à–æ–π</td>
        <td>0.75 ‚ÇΩ</td>
        <td><input type="number" id="input-big" value="0" min="0" onchange="updateFromInput('big')"></td>
        <td><button class="add-btn" onclick="add('big')">+</button></td>
      </tr>
      <tr>
        <td>–£</td>
        <td>1 ‚ÇΩ</td>
        <td><input type="number" id="input-u" value="0" min="0" onchange="updateFromInput('u')"></td>
        <td><button class="add-btn" onclick="add('u')">+</button></td>
      </tr>
    </table>

    <div class="stats">
      <hr>
      <div>–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: <strong><span id="total-items">0</span></strong></div>
      <div>–°—É–º–º–∞: <strong><span id="total-sum">0.00</span> ‚ÇΩ</strong></div>
    </div>

    <button class="save-btn" onclick="saveDay()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–µ–Ω—å</button>
    <button class="reset-btn" onclick="resetCounts()">‚ôªÔ∏è –°–±—Ä–æ—Å–∏—Ç—å —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å</button>
    <button class="clear-history-btn" onclick="clearHistory()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
  </div>

  <div class="history card">
    <h2 style="font-size:18px; margin-top:0;">–ò—Å—Ç–æ—Ä–∏—è</h2>
    <table id="history-table">
      <thead>
        <tr>
          <th>–î–∞—Ç–∞</th>
          <th>–ö–æ–ª-–≤–æ</th>
          <th>–°—É–º–º–∞ (‚ÇΩ)</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="total-summary" id="monthly-total"></div>
  </div>

  <script>
    const prices = { small: 0.35, big: 0.75, u: 1.0 };
    const counts = { small: 0, big: 0, u: 0 };

    const els = {
      small: document.getElementById('input-small'),
      big: document.getElementById('input-big'),
      u: document.getElementById('input-u'),
      totalItems: document.getElementById('total-items'),
      totalSum: document.getElementById('total-sum'),
      historyBody: document.querySelector('#history-table tbody'),
      monthlyTotal: document.getElementById('monthly-total')
    };

    function updateDisplay() {
      els.small.value = counts.small;
      els.big.value = counts.big;
      els.u.value = counts.u;
      const totalItems = counts.small + counts.big + counts.u;
      const totalSum = counts.small * prices.small + counts.big * prices.big + counts.u * prices.u;
      els.totalItems.textContent = totalItems;
      els.totalSum.textContent = totalSum.toFixed(2);
    }

    function add(type) {
      counts[type]++;
      updateDisplay();
    }

    function updateFromInput(type) {
      const value = parseInt(els[type].value) || 0;
      counts[type] = Math.max(0, value);
      updateDisplay();
    }

    function resetCounts() {
      if (confirm("–°–±—Ä–æ—Å–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è?")) {
        counts.small = counts.big = counts.u = 0;
        updateDisplay();
      }
    }

    function saveDay() {
      const totalItems = counts.small + counts.big + counts.u;
      const totalSum = counts.small * prices.small + counts.big * prices.big + counts.u * prices.u;
      if (totalItems === 0) {
        alert("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.");
        return;
      }

      const today = new Date().toLocaleDateString('ru-RU');
      let history = JSON.parse(localStorage.getItem('packingHistory') || '[]');
      history.push({ date: today, totalItems, totalSum: totalSum.toFixed(2) });
      localStorage.setItem('packingHistory', JSON.stringify(history));

      alert("–î–µ–Ω—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω!");
      counts.small = counts.big = counts.u = 0;
      updateDisplay();
      loadHistory();
    }

    function loadHistory() {
      let history = JSON.parse(localStorage.getItem('packingHistory') || '[]');
      els.historyBody.innerHTML = '';
      let monthlySum = 0;
      history.forEach(entry => {
        monthlySum += parseFloat(entry.totalSum);
        const row = `<tr><td>${entry.date}</td><td>${entry.totalItems}</td><td>${entry.totalSum}</td></tr>`;
        els.historyBody.insertAdjacentHTML('beforeend', row);
      });
      els.monthlyTotal.textContent = history.length
        ? `–í—Å–µ–≥–æ –∑–∞ –º–µ—Å—è—Ü: ${monthlySum.toFixed(2)} ‚ÇΩ`
        : '';
    }

    function clearHistory() {
      if (confirm("–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.")) {
        localStorage.removeItem('packingHistory');
        loadHistory();
      }
    }

    loadHistory();
    updateDisplay();
  </script>
</body>
</html>
